<div class="row">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1>
                <i class="fas fa-book"></i> Book Details
            </h1>
            <div class="btn-group">
                <a href="/books/{{book.id}}/edit" class="btn btn-primary">
                    <i class="fas fa-edit"></i> Edit
                </a>
                <button class="btn btn-danger" onclick="deleteBook('{{book.id}}')">
                    <i class="fas fa-trash"></i> Delete
                </button>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header">
                <div class="d-flex justify-content-between align-items-center">
                    <h3 class="mb-0">{{book.title}}</h3>
                    <div class="d-flex gap-2">
                        <span class="badge {{#if book.available}}bg-success{{else}}bg-danger{{/if}} fs-6">
                            {{#if book.available}}Available{{else}}All Checked Out{{/if}}
                        </span>
                        {{#if book.totalCopies}}
                        <span class="badge bg-info fs-6">
                            {{book.availableCopies}}/{{book.totalCopies}} copies
                        </span>
                        {{else}}
                        <span class="badge bg-secondary fs-6">
                            No copies
                        </span>
                        {{/if}}
                    </div>
                </div>
            </div>
            <div class="card-body">
                <div class="row mb-4">
                    <div class="col-sm-3">
                        <strong>Author:</strong>
                    </div>
                    <div class="col-sm-9">
                        {{book.author}}
                    </div>
                </div>

                <div class="row mb-4">
                    <div class="col-sm-3">
                        <strong>ISBN:</strong>
                    </div>
                    <div class="col-sm-9">
                        <code>{{book.isbn}}</code>
                    </div>
                </div>

                {{#if book.publishedYear}}
                <div class="row mb-4">
                    <div class="col-sm-3">
                        <strong>Published Year:</strong>
                    </div>
                    <div class="col-sm-9">
                        {{book.publishedYear}}
                    </div>
                </div>
                {{/if}}

                {{#if book.category}}
                <div class="row mb-4">
                    <div class="col-sm-3">
                        <strong>Category:</strong>
                    </div>
                    <div class="col-sm-9">
                        <span class="badge bg-info">{{book.category}}</span>
                    </div>
                </div>
                {{/if}}

                {{#if book.description}}
                <div class="row mb-4">
                    <div class="col-sm-3">
                        <strong>Description:</strong>
                    </div>
                    <div class="col-sm-9">
                        <p class="mb-0">{{book.description}}</p>
                    </div>
                </div>
                {{/if}}

                <div class="row mb-4">
                    <div class="col-sm-3">
                        <strong>Added:</strong>
                    </div>
                    <div class="col-sm-9">
                        {{formatDate book.createdAt}}
                    </div>
                </div>

                {{#if book.updatedAt}}
                <div class="row mb-4">
                    <div class="col-sm-3">
                        <strong>Last Updated:</strong>
                    </div>
                    <div class="col-sm-9">
                        {{formatDate book.updatedAt}}
                    </div>
                </div>
                {{/if}}
            </div>
        </div>
    </div>

    <div class="col-lg-4">
        <!-- Availability Card -->
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-clipboard-list"></i> Availability
                </h5>
            </div>
            <div class="card-body">
                <div class="row text-center mb-3">
                    <div class="col-3">
                        <div class="statistic">
                            <h4 class="text-primary">{{book.totalCopies}}</h4>
                            <small class="text-muted">Total</small>
                        </div>
                    </div>
                    <div class="col-3">
                        <div class="statistic">
                            <h4 class="text-success">{{book.availableCopies}}</h4>
                            <small class="text-muted">Available</small>
                        </div>
                    </div>
                    <div class="col-3">
                        <div class="statistic">
                            <h4 class="text-warning">{{book.checkedOutCopies}}</h4>
                            <small class="text-muted">Checked Out</small>
                        </div>
                    </div>
                    <div class="col-3">
                        <div class="statistic">
                            <h4 class="text-danger">{{book.maintenanceCopies}}</h4>
                            <small class="text-muted">Maintenance</small>
                        </div>
                    </div>
                </div>

                {{#if book.totalCopies}}
                <!-- Individual Copy Status -->
                <div class="mb-3">
                    <h6 class="text-muted mb-2">Copy Status:</h6>
                    <div class="d-flex flex-wrap gap-1">
                        {{#each book.copies}}
                        <span class="badge {{statusClass status}} fs-6">
                            <i class="{{statusIcon status}}"></i>
                            Copy #{{copy_number}} - {{status}} ({{condition}})
                        </span>
                        {{/each}}
                    </div>
                </div>
                {{/if}}

                {{#if book.available}}
                <div class="d-grid">
                    <a href="/books/{{book.id}}/checkout" class="btn btn-success">
                        <i class="fas fa-check"></i> Available for Checkout
                    </a>
                </div>
                {{else}}
                <div class="d-grid">
                    <button class="btn btn-warning" disabled>
                        <i class="fas fa-clock"></i> All Copies Checked Out
                    </button>
                </div>
                {{/if}}
            </div>
        </div>

        <!-- Actions Card -->
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-tools"></i> Actions
                </h5>
            </div>
            <div class="card-body">
                <div class="d-grid gap-2">
                    <a href="/books/{{book.id}}/edit" class="btn btn-primary">
                        <i class="fas fa-edit"></i> Edit Book
                    </a>
                    <button class="btn btn-outline-secondary" onclick="window.print()">
                        <i class="fas fa-print"></i> Print Details
                    </button>
                    <button class="btn btn-outline-info" onclick="shareBook('{{book.id}}')">
                        <i class="fas fa-share"></i> Share Book
                    </button>
                    <hr>
                    <button class="btn btn-danger" onclick="deleteBook('{{book.id}}')">
                        <i class="fas fa-trash"></i> Delete Book
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Navigation -->
<div class="row mt-4">
    <div class="col-12">
        <div class="d-flex justify-content-between">
            <a href="/books" class="btn btn-outline-secondary">
                <i class="fas fa-arrow-left"></i> Back to Books
            </a>
            <div class="btn-group">
                {{#if previousBook}}
                <a href="/books/{{previousBook.id}}" class="btn btn-outline-primary">
                    <i class="fas fa-chevron-left"></i> Previous
                </a>
                {{/if}}
                {{#if nextBook}}
                <a href="/books/{{nextBook.id}}" class="btn btn-outline-primary">
                    Next <i class="fas fa-chevron-right"></i>
                </a>
                {{/if}}
            </div>
        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div class="modal fade" id="deleteModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Confirm Delete</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete "<strong>{{book.title}}</strong>"?</p>
                <p class="text-danger">This action cannot be undone.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-danger" id="confirm-delete">Delete</button>
            </div>
        </div>
    </div>
</div>